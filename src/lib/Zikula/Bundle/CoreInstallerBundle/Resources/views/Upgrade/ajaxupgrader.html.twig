{% extends '@ZikulaCoreInstaller/theme.html.twig' %}

{% block childjavascripts %}
    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', {"callback": "fos.Router.setData"}) }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/zikulacoreinstaller/js/ajaxcommon.js') }}"></script>
{% endblock %}
{%  block childstylesheets %}
    <link href="{{ asset('bundles/zikulacoreinstaller/css/ajaxinstaller.css') }}" rel="stylesheet" />
{%  endblock %}

{% block title __('Zikula is upgrading!') %}

{% block content %}
<div>
    <div class="progress">
        <div id="progress-bar" class="progress-bar bg-success progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0">
            <span class="sr-only">{{ __('Progress bar') }}</span>
        </div>
    </div>

    <div class="text-center">
        <a href="#upgrade-fieldset" id="beginUpgrade" class="btn btn-lg btn-success">{{ __('Begin Upgrader') }}<br />{{ __('be patient!') }} <i class="fa fa-clock"></i></a>
    </div>

    <fieldset id="upgrade-fieldset">
        <legend>{{  __('Upgrading Modules and Helpers') }}</legend>
        <div class="row">
            <ul id="ajaxList" class="fa-ul text-left">
                {% for stage in stages %}
                <li id="{{ stage.name }}" class="text-muted col-sm-12 col-md-5 offset-md-1 float-left">
                    <span class="fa-li"><i fa fa-circle"></i></span>
                    <span class="pre">{{ stage.pre }}</span>
                    <span class="during d-none">{{ stage.during }} </span>
                    <span class="success d-none">{{ stage.success }}</span>
                    <span class="fail d-none">{{ stage.fail }}</span>
                </li>
                {% endfor %}
            </ul>
        </div>
    </fieldset>

    <div class="text-center">
        <a id="continueButton" href="{{ url('upgrade', {'stage': 'complete'}) }}" class="btn btn-lg btn-success d-none">{{ __('Finish') }} <i class="fa fa-angle-double-right"></i></a>
    </div>
</div>
{# create a javascript array of all the stages #}
<script>
    var stages = [
    {% for stage in stages %}
        "{{ stage.name }}",
    {% endfor %}
    ];
</script>
{% endblock %}
