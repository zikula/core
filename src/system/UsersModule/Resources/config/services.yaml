services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: false
        bind:
            $extension: '@Zikula\UsersModule\ZikulaUsersModule'
            $installed: '%env(ZIKULA_INSTALLED)%'
            $isUpgrading: "@=container.hasParameter('upgrading') ? parameter('upgrading') : false"

    Zikula\UsersModule\:
        resource: '../../*'
        exclude: '../../{bootstrap.php,Tests,vendor}'

    Zikula\UsersModule\Helper\:
        resource: '../../Helper/*'
        lazy: true

    Zikula\UsersModule\Api\ApiInterface\CurrentUserApiInterface: '@Zikula\UsersModule\Api\CurrentUserApi'
    Zikula\UsersModule\Repository\UserAttributeRepositoryInterface: '@Zikula\UsersModule\Repository\UserAttributeRepository'
    Zikula\UsersModule\Repository\UserRepositoryInterface: '@Zikula\UsersModule\Repository\UserRepository'
    Zikula\UsersModule\Repository\UserSessionRepositoryInterface: '@Zikula\UsersModule\Repository\UserSessionRepository'

    # public because this is often required as part of Doctrine listeners
    # which need to access this using container because CurrentUserApi
    # depends on entities as well
    Zikula\UsersModule\Api\CurrentUserApi:
        public: true

    Zikula\UsersModule\Listener\UserEventListener:
        arguments:
          $environment: '%env(APP_ENV)%'
