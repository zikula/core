{% form_theme form with [
    '@ZikulaFormExtension/Form/bootstrap_4_zikula_admin_layout.html.twig',
    '@ZikulaFormExtension/Form/form_div_layout.html.twig'
] %}
{{ adminHeader() }}
<h3>
    <span class="fas fa-wrench"></span>
    {% trans %}Security settings{% endtrans %}
    {{ pageSetVar('title', 'Security settings'|trans) }}
</h3>

{{ form_start(form) }}
{{ form_errors(form) }}
<fieldset>
    <legend>{% trans %}Automatic update settings{% endtrans %}</legend>
    {{ form_row(form.updatecheck) }}
    <div data-switch="zikulasecuritycentermodule_config[updatecheck]" data-switch-value="1">
        {{ form_row(form.updatefrequency) }}
    </div>
</fieldset>
<fieldset>
    <legend>{% trans %}Host settings{% endtrans %}</legend>
    {{ form_row(form.secure_domain) }}
</fieldset>
<fieldset>
    <legend>{% trans %}Cookies settings{% endtrans %}</legend>
    {{ form_row(form.signcookies) }}
    <div data-switch="zikulasecuritycentermodule_config[signcookies]" data-switch-value="1">
        {{ form_row(form.signingkey) }}
    </div>
</fieldset>
<fieldset>
    <legend>{% trans %}Session settings{% endtrans %}</legend>
    {{ form_row(form.seclevel) }}
    <div data-switch="zikulasecuritycentermodule_config[seclevel]" data-switch-value="Medium">
        {{ form_row(form.secmeddays) }}
    </div>
    <div data-switch="zikulasecuritycentermodule_config[seclevel]" data-switch-value="Medium,High">
        {{ form_row(form.secinactivemins) }}
    </div>
    {{ form_row(form.sessionstoretofile) }}
    <div data-switch="zikulasecuritycentermodule_config[sessionstoretofile]" data-switch-value="1" class="form-group">
        {{ form_row(form.sessionsavepath) }}
    </div>
    {{ form_row(form.sessionname) }}
</fieldset>
<fieldset id="securitycenter_ids">
    <legend>{% trans %}Intrusion Detection System{% endtrans %}</legend>
    {{ form_row(form.useids) }}
    <div data-switch="zikulasecuritycentermodule_config[useids]" data-switch-value="1">
        <p class="col-sm-offset-3 col-sm-9 help-block alert alert-info">
            {% trans %}PHPIDS performs many different checks which return an impact value for scoring the treated request. Depending on the sum of all impacts performed actions are selected.{% endtrans %}
            {% trans %}Read more about this system on the <a href="http://phpids.org" title="PHPIDS homepage">PHPIDS homepage</a>.{% endtrans %}
        </p>
        {{ form_row(form.idssoftblock) }}
        {{ form_row(form.idsmail) }}
        {{ form_row(form.idsfilter) }}
        {{ form_row(form.idsrulepath) }}
        {{ form_row(form.idsimpactthresholdone) }}
        {{ form_row(form.idsimpactthresholdtwo) }}
        {{ form_row(form.idsimpactthresholdthree) }}
        {{ form_row(form.idsimpactthresholdfour) }}
        {{ form_row(form.idsimpactmode) }}
        {{ form_row(form.idshtmlfields) }}
        {{ form_row(form.idsjsonfields) }}
        {{ form_row(form.idsexceptions) }}
    </div>
</fieldset>
<fieldset>
    <legend>{% trans %}Output filter settings{% endtrans %}</legend>
    {{ form_row(form.outputfilter) }}
</fieldset>
<div class="form-group row">
    <div class="col-md-9 offset-md-3">
        {{ form_widget(form.save) }}
        {{ form_widget(form.cancel) }}
    </div>
</div>
{{ form_end(form) }}
{{ adminFooter() }}
